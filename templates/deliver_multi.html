{% extends "base.html" %}

{% block title %}Entrega/devolución múltiple · {{ category_code }}{% endblock %}

{% block content %}
<div class="content-container">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <h2 class="page-title mb-1">
        Entrega / devolución múltiple · {{ category_code }}
      </h2>
      <small class="text-muted">
        Aplica la misma entrega o devolución para todas las tarjetas seleccionadas.
      </small>
    </div>
  </div>

  <div class="mb-3">
    <h6 class="mb-1">Tarjetas seleccionadas ({{ cards|length }})</h6>
    <div class="small text-muted">
      {% for c in cards %}
        <span class="badge bg-light text-dark border me-1 mb-1">
          ID {{ c.id }} · {{ c.numero_tarjeta or 'Sin número' }}
        </span>
      {% endfor %}
    </div>
  </div>

  <div class="filter-card">
    <form method="post">
      <input type="hidden" name="ids" value="{{ ids_str }}">

      <div class="row g-3">
        <div class="col-md-3">
          <label class="form-label">RUT</label>
          <input type="text" name="rut" class="form-control"
                 value="{{ form_data.rut }}">
        </div>
        <div class="col-md-3">
          <label class="form-label">Nombre</label>
          <input type="text" name="nombre" class="form-control"
                 value="{{ form_data.nombre }}">
        </div>
        <div class="col-md-3">
          <label class="form-label">Cargo</label>
          <input type="text" name="cargo" class="form-control"
                 value="{{ form_data.cargo }}">
        </div>
        <div class="col-md-3">
          <label class="form-label">Empresa</label>
          <input type="text" name="empresa" class="form-control"
                 value="{{ form_data.empresa }}">
        </div>
      </div>

      <div class="row g-3 mt-2">
        <div class="col-md-4">
          <label class="form-label">Fecha/hora de entrega</label>
          <input type="text" name="entrega_at" class="form-control"
                 value="{{ form_data.entrega_at }}">
          <div class="form-text">Formato: YYYY-MM-DD HH:MM:SS (dejar vacío para ahora)</div>
        </div>
        <div class="col-md-4">
          <label class="form-label">Fecha/hora de devolución</label>
          <input type="text" name="devolucion_at" class="form-control"
                 value="{{ form_data.devolucion_at }}">
          <div class="form-text">Déjalo vacío si solo quieres registrar la entrega.</div>
        </div>
      </div>

      <div class="mt-3 d-flex justify-content-between">
        <a href="{{ url_for('category_view', category_code=category_code) }}"
           class="btn btn-sm btn-outline-secondary">
          <i class="fa-solid fa-arrow-left"></i> Volver al listado
        </a>
        <button type="submit" class="btn btn-primary-custom">
          <i class="fa-solid fa-floppy-disk"></i>
          Guardar entrega / devolución para {{ cards|length }} tarjetas
        </button>
      </div>
    </form>
  </div>
</div>
{% endblock %}
